---
title: "Learnr Tutorial Demo"
output: 
  learnr::tutorial:
    fig_caption: no
    progressive: true
    allow_skip: true
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
# load packages
library(learnr)
library(gradethis)
library(sortable)
library(tidyverse)

# load data
ikea <- read_csv("data/ikea.csv")

# don't echo chunks
knitr::opts_chunk$set(echo = FALSE)

# apply theme to ggplot
ggplot2::theme_set(theme_bw())
```

## Part 1: Writing questions

### Multiple choice

Below are side-by-side boxplots comparing the price of three categories of furniture at Ikea.

```{r}
ikea |> 
  filter(category %in% c("Tables & desks", "Sofas & armchairs", "Beds")) |>
ggplot(aes(x = category, y = price_usd, fill = category)) +
  geom_boxplot() + 
  guides(fill = "none") +
  labs(x = "Furniture category", 
       y = "Price (in $)")
```

```{r mc-variability}
question("Which category of furniture has the least variability in the price?", 
         answer("Beds"), 
         answer("Sofas & armchairs"), 
         answer("Tables & desk", correct = TRUE), 
         answer("The variability is the same for all three categories")
)
```

You can also add options to the questions to allow retries, random order, and hints for incorrect responses.

```{r mc-variability-hint}
question("Which category of furniture has the least variability in the price?", 
         answer("Beds"), 
         answer("Sofas & armchairs"), 
         answer("Tables & desk", correct = TRUE), 
         answer("The variability is the same for all three categories"), 
         incorrect = "Consider the width of the distribution for each category.", 
         allow_retry = TRUE, 
         random_answer_order = TRUE
)
```

### Writing exercises

Write code to identify the categories in the Ikea data set and the number of observations in each category.

```{r count, exercise = TRUE}


```

### Writing exercises with code

You can add some code to the code chunk to get started. We can also specify the number of lines in the output box.

```{r count-starter, exercise = TRUE, exercise.lines = 5}
ikea |>
  ____(___)
```

### Writing exercises with code, hints, and solutions

You can add hints and solutions to exercises.

Calculate the average price of `Sofas & armchairs` and `Tables & desks`. Which category has the highest price on average?

```{r avg-price, exercise = TRUE, exercise.lines = 5}
ikea
```

```{r avg-price-hint-1}
ikea |> 
  filter(category %in% c(____)) |>
  ____ |>
  ____
```

```{r avg-price-hint-2}
ikea |>
  filter(category %in% c("Sofas & armchairs", "Tables & desks")) |>
  group_by(___) |>
  ___

```

```{r avg-price-solution}
ikea |> 
  filter(category %in% c("Sofas & armchairs", "Tables & desks")) |>
  group_by(category) |>
  summarise(avg_price = mean(price_usd))
```

## Part 2: Checking code

You can check code responses using the **gradethis** package.

### Check code

Count the number of times with a price greater than \$300.

```{r filter, exercise = TRUE}

```

```{r filter-solution}
ikea |>
  filter(price_usd > 300) |>
  nrow()
```

```{r filter-check}
grade_this_code()
```

### Check code results

Checking result not the code. Submit the response as a single number, not in a data frame.

```{r filter2, exercise = TRUE}

```

```{r filter2-solution}
ikea |>
  filter(price_usd > 300) |>
  nrow()
```

```{r filter2-check}
grade_this({
  if (identical(.result, ikea |> filter(price_usd > 300) |> nrow())) {
    pass("Great work! You found the number of furniture items greater that cost more than $300!")
  } 
  fail("Not quite but keep trying!")
})
```

## Part 3: Sorting questions

You can create ranking questions using the sortable R package.

Put the following steps in the correct order to bake a cake.

```{r sorting-exercise}
# Define the answer options
baking_steps <- c("Mix the ingredients.", 
           "Bake the cake.", 
           "Decorate the cake.", 
           "Slice the cake.")


# Write the exercise 
question_rank(
  "Sort the steps to bake and serve a cake in the correct order.",
  answer(baking_steps, correct = TRUE),
  answer(rev(baking_steps), correct = FALSE, message = "Other direction!"),
  allow_retry = TRUE
)
```

## Part 4: Building questions

## Part 5: Write your own questions

## Part 6: Minute paper

```{=html}
<iframe src="https://docs.google.com/forms/d/e/1FAIpQLScsV-_m3unjj1S-NSsMjBir-yxrObaLbdS3ypzTe1tPoYv8gQ/viewform?embedded=true" width="640" height="372" frameborder="0" marginheight="0" marginwidth="0">Loadingâ€¦</iframe>
```
## Part 7: Submit response
